<?php/**  * @Framework Zend Framework * @Powered By TIS  $select->where("$this->_name.degree_id=?", $id); * @category   ERP ProductgetRecordbyDegreeId * @copyright  Copyright (c) 2014-2015 Techintegrasolutions Pvt Ltd. * (http://www.techintegrasolutions.com) *	Authors Kannan and Rajkumar */class Application_Model_FeeCategory extends Zend_Db_Table_Abstract{    public $_name = 'erp_fee_category_master';    protected $_id = 'category_id';      //get details by record for edit	public function getRecord($id)    {               $select=$this->_db->select()                      ->from($this->_name)                      ->where("$this->_id=?", $id)				   					  ->where("$this->_name.status !=?", 2);        $result=$this->getAdapter()                      ->fetchRow($select);               return $result;    }    	public function getRecordbyDegreeId($id,$fund_type)    {               $select=$this->_db->select()                      ->from($this->_name)                      ->where("degree_id=?", $id)				                           ->where("fund_type=?", $fund_type)	                        //->where("session_id=?", $fund_type)                      //  ->where("dept_id=?", $dept)					  ->where("$this->_name.status !=?", 2);        $result=$this->getAdapter()                      ->fetchAll($select);               return $result;    }        	public function getRecordbyDegreeId3($id,$fund_type,$session,$dept)    {               $select=$this->_db->select()                      ->from($this->_name)                      ->where("degree_id=?", $id)				                           ->where("fund_type=?", $fund_type)	                        ->where("session_id=?", $session)                        ->where("dept_id=?", $dept)					  ->where("$this->_name.status !=?", 2);        $result=$this->getAdapter()                      ->fetchAll($select);               return $result;    }                	public function getRecordByDegreeId1($id,$session,$dept_type)    {               $select=$this->_db->select();                      $select->from($this->_name);                      $select->where("$this->_name.degree_id=?", $id);	                      if($session >= 7){                        $select->where("$this->_name.session_id=?", $session);                         $select->where("$this->_name.dept_id=?", $dept_type);                      }                      else{                         $select->where("$this->_name.session_id=?", $session);                         $select->where("$this->_name.dept_id=?", $dept_type);                                               }					  $select->where("$this->_name.status !=?", 2);        $result=$this->getAdapter()                      ->fetchAll($select);               // echo $select;die;        return $result;    }    		public function getaccnameRecord($id)    {               $select=$this->_db->select()                      ->from('account_master')                      ->where("id=?", $id)				   					  ->where("account_master.status !=?", 2);        $result=$this->getAdapter()                      ->fetchRow($select);       //echo "<pre>"; print_r($result); die;        return $result;    }	//Get all records	public function getRecords()    {               $select=$this->_db->select()                      ->from($this->_name)    					  ->where("$this->_name.status !=?", 2)                    ->group(array("$this->_name.degree_id","$this->_name.fund_type","session_id","dept_id"))					  ->order("$this->_id DESC");        $result=$this->getAdapter()                      ->fetchAll($select);         return $result;    }				   public function getDropDownList()	{        $select = $this->_db->select()		    ->from($this->_name,array('category_id', 'category_name'))			->where("$this->_name.status!=?",2)			->order('category_id  ASC');        $result = $this->getAdapter()->fetchAll($select);		//echo'<pre>';print_r($result);die;      $data = array();        foreach($result as $k=>$vals) {						$data[$vals['category_id']] = $vals['category_name'];			        }		        return $data;     }               public function getAccDropDownList()	{        $select = $this->_db->select()		    ->from("account_master",array('id', 'acc_name'))			->where("account_master.status =?",0)			->order('acc_name  ASC');        $result = $this->getAdapter()->fetchAll($select);		//echo'<pre>';print_r($result);die;      $data = array();        foreach($result as $k=>$vals) {						$data[$vals['id']] = $vals['acc_name'];			        }		        return $data;     }			public function getCategory($degree_id='',$session=0,$dept_type=0)	{        $select = $this->_db->select();		    $select->from($this->_name,array('category_name','category_id'));		    			//->joinleft(array("feeheads"=>"erp_fee_heads_master"),"$this->_name.category_id=feeheads.feecategory_id",array("feecategory_id"))			//->joinleft(array("feehead_items"=>"erp_fee_heads_items"),"feehead_items.feehead_id=feeheads.feehead_id",array("feehead_name"))			$select->where("$this->_name.status!=?",2);            $select->where("$this->_name.degree_id = ?",$degree_id);            if($session){             $select->where("$this->_name.session_id = ?",$session);             if($dept_type > 0)             $select->where("$this->_name.dept_id=?", $dept_type);}//             else{//             $select->where("$this->_name.session_id = ?",0);}			$select->order('category_id  ASC');		//echo $select;die;        $result = $this->getAdapter()->fetchAll($select);		//echo'<pre>';print_r($result);die;        return $result;     }                    	public function getFeeCategory($degree_id='',$acc_name = '',$session = 0, $dept_type= 0)	{        $select = $this->_db->select();		    $select->from($this->_name,array('category_name','category_id'));		    			$select->join(array("acc_m"=>"account_master"),"$this->_name.fund_type=acc_m.id",array());          //  ->join(array("term_items"=>"erp_fee_structure_term_items"),"feeheads.feehead_id=term_items.fee_heads_id",array("GROUP_CONCAT(fees) as totfee"))			//->joinleft(array("feehead_items"=>"erp_fee_heads_items"),"feehead_items.feehead_id=feeheads.feehead_id",array("feehead_name"))			$select->where("$this->_name.status!=?",2);			$select->where("acc_m.acc_name = ?",$acc_name);			if($session >= 7){             $select->where("$this->_name.session_id = ?",$session);             if($dept_type > 0)             $select->where("$this->_name.dept_id=?", $dept_type);}             else{             $select->where("$this->_name.session_id = ?",0);}            $select->where("$this->_name.degree_id = ?",$degree_id);           // ->where("term_items.terms_id = ?",$term_master)            //->group("$this->_name.category_id")			$select->order("$this->_name.category_id  ASC");        $result = $this->getAdapter()->fetchAll($select);		//echo'<pre>';print_r($result);die;        return $result;     }        public function getFeeCategoryByDeptSession($dept_type,$session)	{        $select = $this->_db->select();        $select->from($this->_name);            $select->where("$this->_name.status!=?",2);        $select->where("$this->_name.dept_id=?", $dept_type);        $select->where("$this->_name.session_id=?", $session);        $select->order("$this->_name.category_id  ASC");        $result = $this->getAdapter()->fetchAll($select);        return $result;     }		public function getCategoryIds()	{        $select = $this->_db->select()		    ->from($this->_name,'category_id')			//->joinleft(array("feeheads"=>"erp_fee_heads_master"),"$this->_name.category_id=feeheads.feecategory_id",array("feecategory_id"))			//->joinleft(array("feehead_items"=>"erp_fee_heads_items"),"feehead_items.feehead_id=feeheads.feehead_id",array("feehead_name"))			->where("$this->_name.status!=?",2)			->order('category_id  ASC');		//echo $select;die;        $result = $this->getAdapter()->fetchAll($select);		//echo'<pre>';print_r($result);die;        return $result;     }        public function dumpdata($mig_session,$dept_id){        $this->_db->delete("erp_fee_category_master",            array(                "dept_id =?"=> $dept_id,                "session_id =?" => $mig_session            )                     );    }}?>