<?php //echo "<pre>";print_r($this->elective);exit;   ?>
<style type="text/css">

    .bold-checkbox{
        position: absolute; top: 12px; font-weight:bold;
    }

</style>

<style>



    @media print {
        table td:nth-child(9)
        {
            display:none;
        }
        table th:nth-child(9)
        {
            display:none;
        }
        table td:nth-child(10)
        {
            display:none;
        }
        table th:nth-child(10)
        {
            display:none;
        }
        *{
            visibility:hidden;
        }
        table,th,td 
        {
            visibility:visible;                    
        } 
        .title1
        {
            visibility:visible; 
        }
    }
    #custom_data_records{
        width:100%;
        text-align: right;
        font-size:1.5em;

    }
    
    .load-box{
        display:none;
        position:absolute;
        width:100%;
        height:100%;
        background:rgba(255,255,255,.4);
        z-index: 999;
    }
    
    .load-box>img{
        position:absolute;
        top:50%;
        left:50%;
        width:40em;
        transform: translate(-50%,-50%);
        
        
    }
    
</style>
<link href="<?php echo $this->mainconfig['publicpath']; ?>css/custom.css" rel="stylesheet">

<div class="right_col">

    <?php if ($this->type) { ?>
        <div class="padding-md">
            <?php
            if (count($this->messages)) {
                foreach ($this->messages as $message) {
                    ?>
                    <div <?php
                    if ($_SESSION['admin_login']['admin_login']->flash_error == 0) {
                        echo 'class="alert alert-danger"';
                        $_SESSION['admin_login']['admin_login']->flash_error = 1;
                    } else {
                        echo "class='alert alert-success'";
                    }
                    ?>>
                        <a type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</a>
                        <?php echo $this->escape($message); ?>
                    </div>
                <?php
                }
            }
            ?>
            <div class="row">
                <div class="col-md-12">
                    <h3 class="page-title txt-color-blueDark" >
                        <div><i class="fa fa-eye"> Participants Enrollment</i></div>
                    </h3>
                    <div class="panel panel-default">
                        <form class="no-margin" id="formValidate1" action="<?php echo $this->form->getAction() ?>" method="post" data-validate="parsley"  enctype="multipart/form-data">

                            <div class="panel-body">

                                <div class="row">
                                    <div class="col-sm-3"><h4><span style="color:#777;">Academic Details</span></h4></div>
                                </div>
                                <div class="row masterbox">
                                    <div class="row">
                                 
                                       
                                        <div class="col-sm-3 employee_class">
                                            <div class="form-group disabled" >
                                                <label class="control-label">Batch<span class="asterisk">*</span></label>
                                                <?php echo $this->form->academic_id; ?>
                                            </div>
                                        </div>

                                        <!--<div class="col-sm-3 employee_class">
            <div class="form-group">
              <label class="control-label">Term<span class="asterisk">*</span></label>
    <?php //echo $this->form->terms_id;    ?>
            </div>
                                        </div> 
                                        <div class="col-sm-3 employee_class">
            <div class="form-group">
              <label class="control-label">Year<span class="asterisk">*</span></label>
    <?php echo $this->form->year; ?>
            </div>
                                        </div>-->
                                        <div class="col-sm-3 employee_class">
                                            <div class="form-group disabled">
                                                <label class="control-label">UID<span class="asterisk">*</span></label>
                                                <div style="position:absolute">
                                                    <?php echo $this->form->stu_id; ?>
                                                </div>
                                               <!-- <div style="position:absolute"><input id='read_id' class="form-control" type='text' readonly="" value=""/></div>-->
                                            </div>
                                        </div>

    <?php if ($this->type == 'edit'): ?>
                                            <div class="col-sm-offset-3 col-sm-3 employee_class">
                                                <div class="form-group">
                                                    <?php if ($this->result['filename']): ?>
                                                        <img class="img img-rounded" src="<?= $this->baseUrl($this->result['filename']); ?>" width="100px" alt="img" />
        <?php endif; ?>
                                                </div>
                                            </div>
    <?php endif; ?>


                                        <?php
                                        if ($this->type == 'add') {
                                            ?>
                                            <!--                                            <div class="col-sm-3 employee_class">
                                                                                            <div class="form-group disabled">
                                                                                                <label class="control-label">&nbsp;</label><br/>
                                                                                                <button id="btn-get-discont-student" class="block" onclick="fetchDiscontinuedStudentDetail();return false;">Get Discontinued Participant Detail</button>
                                                                                            </div>
                                                                                        </div>-->
                                            <?php
                                        }
                                        ?>

                                        .                           
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-3">
                                            <div class="form-group">
                                                <input type="text" id="batch" class="form-control" style="background-color:#fdf59a;" readonly /></div>
                                        </div>
                                    </div>
                                </div>


                                <div class="row">

                                    <div class="col-sm-3"><h4><span style="color:#777;">Optional Courses<small> (For Semester 1)</small></span></h4></div>
                                </div>
                                <div class="row masterbox">
                                    <div class="row">   
                                        <div class="col-sm-3 employee_class">
                                            <div class="form-group disabled">
                                                <label class="control-label">General Electives <span class="asterisk">*</span></label>
    <?php echo $this->form->ge; ?>
                                            </div>
                                        </div> 
                                        <div class="col-sm-3 employee_class">
                                            <div class="form-group disabled">
                                                <label class="control-label">AECC Course<span class="asterisk">*</span></label>
    <?php echo $this->form->aecc; ?>
                                            </div>
                                        </div> 
                                    </div>
                                </div>



                                <div class="row">

                                    <div class="col-sm-3"><h4><span style="color:#777;">Participants Details</span></h4></div>
                                </div>
                                <div class="row masterbox">
                                    <div class="row">   

                                        <div class="col-sm-3 employee_class">
                                            <div class="form-group disabled">
                                                <label class="control-label">First Name <span class="asterisk">*</span></label>
    <?php echo $this->form->stu_fname; ?>
                                            </div>
                                        </div> 

                                        <div class="col-sm-3 employee_class">
                                            <div class="form-group disabled">
                                                <label class="control-label">Last Name<span class="asterisk">*</span></label>
    <?php echo $this->form->stu_lname; ?>
                                            </div>
                                        </div>

                                        <div class="col-sm-3 employee_class">
                                            <div class="form-group disabled">
                                                <label class="control-label">Gender<span class="asterisk">*</span></label>
    <?php echo $this->form->gender; ?>
                                            </div>
                                        </div>  

                                        <div class="col-sm-3 employee_class">
                                            <div class="form-group disabled">
                                                <label class="control-label">Mobile Number<span class="asterisk">*</span></label>
    <?php echo $this->form->stu_mobileno; ?>
                                            </div>
                                        </div>

                                        <div class="col-sm-3 employee_class">
                                            <div class="form-group disabled">
                                                <label class="control-label">Email ID<span class="asterisk">*</span></label>
    <?php echo $this->form->stu_email_id; ?>
                                                <span id="erremail" style="color:red;"></span>
                                            </div>
                                        </div>

                                        <div class="col-sm-3 employee_class">
                                            <div class="form-group disabled">
                                                <label class="control-label">Date of Birth</label>
    <?php echo $this->form->stu_dob; ?>
                                                <span id="dobError" style="color:red;"></span>
                                              
                                            </div>  
                                        </div>

                                        <div class="col-sm-3 employee_class">
                                            <div class="form-group disabled">
                                                <label class="control-label">Blood Group</label>
    <?php echo $this->form->blood_group; ?>
                                               <span id="erremail" style="color:red;"></span>
                                            </div>
                                        </div>

                                        <div class="col-sm-3 employee_class">
                                            <div class="form-group disabled">
                                                <label class="control-label">Present Address<span class="asterisk">*</span></label>
    <?php echo $this->form->present_addr; ?>
                                            </div>
                                        </div>
                                    </div>
                                    <div class='row'>

                                        <div class="col-sm-3 employee_class">
                                            <div class="form-group disabled">
                                                <label class="control-label">Permanent Address</label>
    <?php echo $this->form->premanent_addr; ?>
                                            </div>
                                        </div>

                                        <div class="col-sm-3 employee_class">
                                            <div class="form-group disabled">
                                                <label class="control-label">Status &nbsp;&nbsp;<?php if ($this->result['participant_Alumni'] == 1) { ?>  <span id='Alumni_text' style="color:red;">(Alumni)</span><?php } ?></label>
    <?php echo $this->form->stu_status; ?>
                                            </div>
                                        </div>

                                        <div class="col-sm-3 employee_class">
                                            <div class="form-group disabled">
                                                <label class="control-label" id="eff_date">Effective Date</label>
    <?php echo $this->form->effective_date; ?>
                                            </div>
                                        </div>

                                        <div class="col-sm-3 employee_class">
                                            <div class="form-group disabled">
                                                <label class="control-label" id="advice_label">Advice</label>
    <?php echo $this->form->adv_col; ?>
                                            </div>
                                        </div>

                                    </div>  
                                </div>  
                                <div class="row">   
                                    <div class="col-sm-3"><h4><span style="color:#777;">Parent Details</span></h4></div>
                                </div>

                                <div class="row masterbox">
                                    <div class="row">
                                        <div class="col-sm-3 employee_class">
                                            <div class="form-group disabled">
                                                <label class="control-label">Father First Name <span class="asterisk">*</span></label>
    <?php echo $this->form->father_fname; ?>
                                            </div>
                                        </div> 

                                        <div class="col-sm-3 employee_class">
                                            <div class="form-group disabled">
                                                <label class="control-label">Father Last Name<span class="asterisk">*</span></label>
    <?php echo $this->form->father_lname; ?>
                                            </div>
                                        </div>

                                        <div class="col-sm-3 employee_class">
                                            <div class="form-group disabled">
                                                <label class="control-label">Father Mobile Number<span class="asterisk">*</span></label>
    <?php echo $this->form->father_mobileno; ?>
                                            </div>
                                        </div>


                                        <div class="col-sm-3 employee_class">
                                            <div class="form-group disabled">
                                                <label class="control-label">Mother First Name <span class="asterisk">*</span></label>
    <?php echo $this->form->mother_fname; ?>
                                            </div>
                                        </div>
                                        <div class="col-sm-3 employee_class">
                                            <div class="form-group disabled">
                                                <label class="control-label">Mother Last Name<span class="asterisk">*</span></label>
    <?php echo $this->form->mother_lname; ?>
                                            </div>
                                        </div>

                                        <div class="col-sm-3 employee_class">
                                            <div class="form-group disabled">
                                                <label class="control-label">Mother Mobile Number</label>
    <?php echo $this->form->mother_mobileno; ?>
                                            </div>
                                        </div>

                                        <div class="col-sm-3 employee_class">
                                            <div class="form-group disabled">
                                                <label class="control-label">Linkedin URL</label>
    <?php echo $this->form->linked_in; ?>
                                                <span id="erremail2" style="color:red;"></span>
                                            </div>
                                        </div>

                                    </div>
                                    <div class="col-sm-3 employee_class">
                                        <div class="form-group disabled">
                                            <label class="control-label">Secondary Email</label>
    <?php echo $this->form->secondary_mail; ?>
                                            <span id="erremail1" style="color:red;"></span>
                                        </div>
                                    </div>

                                </div>
                            </div>

                            <div class="row alumni_panel">  
                                <div class="col-sm-3"><h4><span style="color:#777;">Year of Passing & Alumni Entry</span></h4></div>
                            </div>
                            <div class="row masterbox alumni_panel">
                                <div class="row">
                                    <div class="col-sm-3 employee_class">
    <?= $this->form->passing_year; ?>
                                        <h5 id="nexterror"></h5>
                                    </div>
                                    <div class="col-sm-3">

                                        <input type="checkbox" style="zoom:2" value="1" <?php
                                        if ($this->result['participant_Alumni'] == 1) {
                                            echo 'checked' . " ";
                                            echo 'onclick ="return ConfirmDelete(&quot;Are you sure you want delete this participant as Alumni ?&quot;);"';
                                        } else {
                                            echo 'onclick ="return ConfirmDelete(&quot;Are you sure you want make this participant as Alumni ?&quot;);"';
                                        }
                                        ?> id="passing_status" name="passing_status"  />&nbsp;<span class="bold-checkbox"> Check To Create Alumni !</span>
                                    </div>
                                    <div class="col-sm-3">

                                        <input type="checkbox" style="zoom:2" value="1" <?php
                                        if ($this->alumni_detail['display_phone'] == 1) {
                                            echo 'checked' . " ";
                                        }
                                        ?> id="display_phone" name="display_phone"  />&nbsp;<span class="bold-checkbox">Publish Phone Number</span>
                                    </div>
                                </div>
                            </div>  
                            <div id="participants_credentials" >
                                <div class="row">   
                                    <div class="col-sm-3"><h4><span style="color:#777;">Enter participants Credentials</span></h4></div>
                                </div>
                                <div class="row masterbox">
                                    <div class="row">
                                        <div class="col-sm-3 employee_class">
                                            <div class="form-group">
                                                <label class="control-label">User Name <span class="asterisk">*</span></label>
    <?php echo $this->form->participant_username; ?>
                                            </div>
                                        </div>
                                        <div class="col-sm-3 employee_class">
                                            <div class="form-group">
                                                <label class="control-label">Password<span class="asterisk">*</span></label>
    <?php echo $this->form->participant_pword; ?>
                                                <div class="form-control-static">
                                                    Default Password - 6 digit mobile number(XXXX123456)
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-sm-3 employee_class">
                                            <div class="form-group">
                                                <label class="control-label" >Confirm Password<span class="asterisk">*</span></label>
    <?php echo $this->form->confirm_password; ?><br/>
                                                <h5 id="error"></h5>
                                            </div>
                                        </div>


                                        <div class="col-sm-3">

                                            <span class="glyphicon glyphicon-eye-close" style="position: absolute; top: 32px; font-weight:bold; cursor:pointer;" id="show_password"></span>  <label class="control-label" style="display:none" id="password_label">Show Password</label>
                                        </div>
                                    </div>  

                                </div>
                            </div>

                    </div>
                    <div class="row">   
                        <div class="col-sm-3"><h4><span style="color:#777;">File Upload</span></h4></div>
                    </div>
                    <div class="row masterbox">
                        <div class="row">
                            <div class="col-sm-3 employee_class">
                                <input name="file[]" id="file" type="file" accept="image/jpg, image/jpeg, image/png"  />
                                <div class='form-control-statuc' >
                                    <span class='text-danger'>*only .jpg or .png files can be upload</span>
                                </div>
                            </div>
                        </div>
                    </div>       

                </div>

                <div class="panel-footer">                                  
                    <div class="row">
                        <div class="col-sm-7 col-sm-offset-5">
    <?php if ($this->type == 'add') { ?> 
                                <div style="float:left;margin-right:2px;">
                                    <button class="btn btn-primary submit" onclick="return confirmPword();">Submit</button>
                                </div>
                                <div style="float:left;padding:0px 10px;">
                                    <button type="reset" class="btn btn-danger btn-default" >Reset</button>
                                </div>
    <?php } else { ?>
                                <div style="float:left;">
                                    <button class="btn btn-primary submit" onclick="return confirmPword();">Update</button>
                                </div>
                                <div style="float:left;">
                                    <a class="btn btn-primary" href="<?php echo $this->mainconfig['host']; ?>student/index">Back</a>
                                </div>
    <?php } ?>
                        </div>
                    </div>
                </div>
            </div>
            </form>
        </div><!-- /panel -->
    </div><!-- /.col-->             
    </div><!-- /.row -->

    <!-- /.padding-md -->   
<?php } else { ?>

    <?php
    if (count($this->messages)) {
        foreach ($this->messages as $message) {
            ?>
            <div <?php
            if ($_SESSION['admin_login']['admin_login']->flash_error == 0) {
                echo 'class="alert alert-danger"';
                $_SESSION['admin_login']['admin_login']->flash_error = 1;
            } else {
                echo "class='alert alert-success'";
            }
            ?>>
                <a type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</a>
            <?php echo $this->escape($message); ?>
            </div>
        <?php
        }
    }
    ?>

    <!-- widget grid -->
    <div class="">
      
        <div class="">
            <div class="row">

                <div class="col-xs-12 col-sm-7 col-md-7 col-lg-4">
                    <h3 class="page-title txt-color-blueDark">
                        <i class="fa fa-bars">Participants Enrollment</i>

                    </h3>
                </div>

                <div class="col-xs-12 col-sm-5 col-md-5 col-lg-8">   

                    <a class="btn btn-primary pull-right" style="margin-top: 25px;" href="<?php echo $this->mainconfig['host']; ?>student/index/type/add">Add </a>
                </div>
            </div>

            <div class="x_panel">
  <div class="load-box">
             <img src="<?php echo $this->mainconfig['publicpath']; ?>/images/loader.gif" width='200px'  class="loder_img1" />
        </div>
                <div class="x_title">
                    <div class="row">
                        <div class="col-sm-3">
                            <h2 class="title1">Participants Details</h2></div>
                        <div class="col-sm-2 pul-right ">
                            <div class="form-group">
<!--                                <label class="control-label"> <h2 class="title1"> Session </h2></label>-->
                                <?php echo $this->form->session; ?>
                            </div>
                           
                        </div>
                        <div class="col-sm-2 pul-right ">
                            <div class="form-group">
<!--                                <label class="control-label"> <h2 class="title1"> Session </h2></label>-->
                                <?php echo $this->form->degree_id; ?>
                            </div>
                           
                        </div>
                        <div class="col-sm-2 pul-right ">
                            <div class="form-group">
<!--                                <label class="control-label"> <h2 class="title1"> Session </h2></label>-->
                                <?php echo $this->form->department; ?>
                            </div>
                           
                        </div>
                       
                        <ul class="nav navbar-right panel_toolbox">
                            <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                            </li>
                            <li class="dropdown">
                                <a href="" class="dropdown-toggle" data-toggle="dropdown" role="button"
                                   aria-expanded="false"><i class="fa fa-wrench"></i></a>
                            </li>
                            <li><a class=""><i class="fa fa-close"></i></a>
                            </li>
                        </ul>
                    <div class="clearfix"></div>
                </div>
                     </div>
               
                <div class="x_content">

                    <div class="padding-md clearfix">
                        <div class="col-sm-0" style="float:right;">
                           <!-- <a class="btn btn-primary" target="_blank" href="#<?php //echo $this->mainconfig['host'];                              ?>fee-structure/structure-pdf/id/<?php //echo $this->structure_id;   ?>">Print</a>-->
                            <a class="btn btn-link" role="button" href="#" id="print">
                            <span class='glyphicon glyphicon-print'></span></a>
                        </div>
                        <div class="table-responsive" id="studentData"> 
                            
                        <table class="table table-striped table-bordered mb30 jambo_table bulk_action" id="datatable-responsive" style="height: 100%" >
                            <thead>
                                <tr>
                                    <th >S.  No.</th>
                                    <th>Student Name</th>
                                    <th>Father Name</th>
                                    <th>Batch</th>
                                    <th>Core Course</th>
                                    <th>Generic Electives</th>
                                    <th>AECC</th>
                                    <!--<th>Mobile Number</th>
                                    <th>Email ID</th> -->
                                  
                                   
                                    <th>UID</th>
                                    <th >REG NO.</th>
                                    <th>Exam Roll No.</th>
                                    <th class="no_print">Save & Edit</th>
                                    <th>Status</th>
                                    <th class="no_print">Action</th>
                                </tr>
                            </thead>

                            <tfoot>
                                <tr>
                                    <td colspan="10">Save All</td>
                                    <td ><button type='buttom' class='btn btn-primary' type = "button" >Save All</button></td> 
                                    <td></td>
                                    <td></td>
                                </tr>
                            </tfoot>
                        </table>
                                       </div>
    <?php echo $pagination_tr; ?>
                    </div><!-- /.padding-md -->
                </div><!-- /panel -->
            </div>
        </div>
    </div><!-- /.padding-md -->     
<?php } ?>
</div>

 
<script src="<?php echo $this->mainconfig['publicpath']; ?>js/customradio.js"></script> 
<script>


    
     $(document).ready(function(){
        var cells = [];
        var rows = $("#datatable-responsive").dataTable().fnGetNodes();
        for(var i=0;i<rows.length;i++)
        {
            if($(rows[i]).find("input[type='checkbox']").prop('checked')){
                if($(rows[i]).find("input[type='checkbox']").prev('label').find('i').index()== -1)
            $(rows[i]).find("input[type='checkbox']").prev('label').append('<i class="glyphicon glyphicon-ok"></i>');
        }
        }
    });
    
//------------------ Changes by kedar---------------------------------------------------------

    $("#aecc option[value='19']").remove();
    $('input').focus(function(){
        var selected_date = $("#stu_dob").val();
       
        if(selected_date){
            var current = selected_date;
            var date_components = current.split("/");
            var current_year = parseInt(date_components[2]);
            //console.log(current_year);
            var day = parseInt(date_components[0]);
            var month = parseInt(date_components[1]);
            var age = 16;
            var setDate = new Date(current_year + age, month - 1, day);
            //console.log(setDate);
            var currdate = new Date();

            if (currdate >= setDate) {
                $('#dobError').text("");
                
            } else {
               $('#dobError').text("Your age less than 16 yrs");

            }       
        }
    });
       
    //------------------------------ End ---------------------------------------------------------  
    //=========================[Ajax Save and edit;]========================================================//
    
    $('.changebox').click(function(){
        if($(this).val() == '0000')
       $(this).val(''); 
    });
    $('.changebox').blur(function(){
       if($(this).val() == '')
           $(this).val('0000');
    });

    $('input[type="checkbox"]').click(function () {
        
        var reg_no = 0;
        var exam_roll = 0;
        var id = $(this).data('id');
        var tr_no = $(this).parent('td').parent('tr').index();
        var td_no = $(this).parent('td').index();
        if ($(this).prop('checked')) {

            exam_roll = $('table>tbody>tr:nth-child(' + (tr_no + 1) + ')').children('td:nth-child(' + td_no + ')').children('input').val();
            reg_no = $('table>tbody>tr:nth-child(' + (tr_no + 1) + ')').children('td:nth-child(' + (td_no - 1) + ')').children('input').val();
            //Changes by kedar 25 oct.
            $.ajax({
                type: "POST",
                url: '<?php echo $this->mainconfig['host'] . 'master/ajax-check-existed-result'; ?>',
                 data: {exam_no: exam_roll, reg_no: reg_no, id: id}
            }).done(function (data){
               if (data == 1){
                   
                    alert('Exam And Registration Number Already Exist.');
                   
                    $('table>tbody>tr:nth-child(' + (tr_no + 1) + ')').children('td:nth-child(' + (td_no - 1) + ')').css({"border":'1px solid red'});
                     $('table>tbody>tr:nth-child(' + (tr_no + 1) + ')').children('td:nth-child(' + td_no + ')').css({"border": '1px solid red'});
                   
                   
                }else{
                    $('table>tbody>tr:nth-child(' + (tr_no + 1) + ')').children('td:nth-child(' + (td_no - 1) + ')').removeAttr('style');
                   $('table>tbody>tr:nth-child(' + (tr_no + 1) + ')').children('td:nth-child(' + td_no + ')').removeAttr('style');
                   // $('head').append("<meta http-equiv='refresh' content = '0'>");
                }
            });
            //End
            $.ajax({
                type: "POST",
                url: '<?php echo $this->mainconfig['host'] . 'master/ajax-get-saved-result'; ?>',
                data: {exam_no: exam_roll, reg_no: reg_no, id: id}
            }).done(function (data) {
              //  if (data = 1){
                  reg_no =   $('table>tbody>tr:nth-child(' + (tr_no + 1) + ')').children('td:nth-child(' + (td_no - 1) + ')').children('input').val();
                  exam_roll =   $('table>tbody>tr:nth-child(' + (tr_no + 1) + ')').children('td:nth-child(' + (td_no) + ')').children('input').val();
                  
                  $('table>tbody>tr:nth-child(' + (tr_no + 1) + ')').children('td:nth-child(' + (td_no - 1) + ')').children('input').remove();
                  $('table>tbody>tr:nth-child(' + (tr_no + 1) + ')').children('td:nth-child(' + (td_no) + ')').children('input').remove();
                  
                  
                     $('table>tbody>tr:nth-child(' + (tr_no + 1) + ')').children('td:nth-child(' + (td_no - 1) + ')').append("<label class='changebox' style='font-weight:normal;'>"+reg_no+"</label>");
                       $('table>tbody>tr:nth-child(' + (tr_no + 1) + ')').children('td:nth-child(' + (td_no) + ')').append("<label class='changebox' style='font-weight:normal;'>"+exam_roll+"</label>")
            });
        } else {

            exam_roll = $('table>tbody>tr:nth-child(' + (tr_no + 1) + ')').children('td:nth-child(' + (td_no-1) + ')').children('label').text();
            reg_no = $('table>tbody>tr:nth-child(' + (tr_no + 1) + ')').children('td:nth-child(' + (td_no) + ')').children('label').text();
            
            exam_roll_text = $('table>tbody>tr:nth-child(' + (tr_no + 1) + ')').children('td:nth-child(' + (td_no-1) + ')').children('input').val();
            reg_no_text = $('table>tbody>tr:nth-child(' + (tr_no + 1) + ')').children('td:nth-child(' + (td_no) + ')').children('input').val();

            $('table>tbody>tr:nth-child(' + (tr_no + 1) + ')').children('td:nth-child(' + td_no + ')').children('label').remove();
            $('table>tbody>tr:nth-child(' + (tr_no + 1) + ')').children('td:nth-child(' + (td_no - 1) + ')').children('label').remove();
            
            if(exam_roll_text !='0000'){
            $('table>tbody>tr:nth-child(' + (tr_no + 1) + ')').children('td:nth-child(' + (td_no - 1) + ')').append("<input type='text' size='12' class='changebox form-control' name='reg_no' data-reg = '"+id+"'  value='" + exam_roll + "'/>")}
            
            if(reg_no_text !='0000'){
            $('table>tbody>tr:nth-child(' + (tr_no + 1) + ')').children('td:nth-child(' + (td_no) + ')').append("<input type='text'  size='12' data-exam = '"+id+"' class='changebox form-control' name='exam_roll' value='" + reg_no + "'/>");}

        }

    });
//=========================[END]=================================================================// 

$('button').click(function(){

var reg_no = [];
var reg_id = []
var roll_no = [];
var roll_id = [];
$('.load-box').show();
$('input[name="reg_no"]').each(function(e){
   reg_no.push($(this).val());
   reg_id.push($(this).data('reg'));
    
});

$('input[name="exam_roll"]').each(function(e){
    roll_no.push($(this).val());
    roll_id.push($(this).data('exam'));
    
});
if(reg_no.length >0 || roll_no > 0 ){
   $.ajax({
                type: "POST",
                url: '<?php echo $this->mainconfig['host'] . 'master/ajax-get-bulk-saved-result'; ?>',
                data: {reg_no: reg_no, reg_id: reg_id, roll_no: roll_no,roll_id:roll_id}
            }).done(function (data) {
               $('head').append("<meta http-equiv='refresh' content = '0'>");
            });
            }

});




    $('#stu_status').change(function () {
        var x = $(this).val();
        if (x == '2') {
            $('.alumni_panel').hide();
        } else
        {
            $('.alumni_panel').show();
        }
    });

    $('#stu_email_id').blur(function () {
        var n = $("#stu_email_id").val().indexOf("@");
        var res = $('#stu_email_id').val().substr(0, n);
        var mobile_len = $('#stu_mobileno').val().length;
        var default_pword = $('#stu_mobileno').val().substr(mobile_len - 6, mobile_len);
        $('#participant_username').val(res);
        $('#participant_pword').val(default_pword);
        $('#confirm_password').val(default_pword);
    });
    $('#stu_mobileno').blur(function () {
        var n = $("#stu_email_id").val().indexOf("@");
        var res = $('#stu_email_id').val().substr(0, n);
        var mobile_len = $('#stu_mobileno').val().length;
        var default_pword = $('#stu_mobileno').val().substr(mobile_len - 6, mobile_len);
        $('#participant_username').val(res);
        $('#participant_pword').val(default_pword);
        $('#confirm_password').val(default_pword);
    });

    $("#show_password").click(function () {
        if ($("#show_password").attr("class") == "glyphicon glyphicon-eye-close") {
            $("#show_password").attr("class", "glyphicon glyphicon-eye-open");
            $("#password_label").empty();
            $("#password_label").text("Hide Password");
            $('#participant_pword').attr('type', 'text');
            $('#confirm_password').attr('type', 'text');
        } else {
            $("#show_password").attr("class", "glyphicon glyphicon-eye-close");
            $('#participant_pword').attr('type', 'password');
            $('#confirm_password').attr('type', 'password');
            $("#password_label").empty();
            $("#password_label").text("Show Password");
        }
    });

    $(document).ready(function () {
        if ($('#passing_status').is(':checked'))
            $('#passing_year').attr("required", "required");

        if ($("#stu_email_id").val() || $('#stu_mobileno').val()) {
            var n = $("#stu_email_id").val().indexOf("@");
            var res = $('#stu_email_id').val().substr(0, n);
            var mobile_len = $('#stu_mobileno').val().length;
            var default_pword = $('#stu_mobileno').val().substr(mobile_len - 6, mobile_len);
        }
        if ($('#participant_username').val() == '')
        {
            $('#participant_username').attr("required", "required");
            $('#participant_username').val(res);

            $('#participant_pword').attr("required", "required");
            $('#participant_pword').val(default_pword);
            $('#confirm_password').attr("required", "required");
            $('#confirm_password').val(default_pword);
        } else
        {
            $('#participant_username').removeAttr("required");
            $('#participant_pword').removeAttr("required");
            $('#confirm_password').removeAttr("required");
        }
        

        $('#stu_dob').datepicker({ format: 'dd/mm/yyyy' });
        $('#effective_date').datepicker({format: 'dd/mm/yyyy'});
        
    
    });


    function confirmPword() {

        var password = $("#participant_pword").val();
        var confirm_pword = $("#confirm_password").val();
        if (password == confirm_pword)
        {

            $("#error").text("redirecting...");
            $("#error").css("color", "green");
            return true;
        } else
        {
            $("#error").text('password does not match');
            $("#error").css("color", "red");
            return false;
        }

    }

    function ConfirmDelete($data)
    {
        var bool = $('input[type=checkbox]').prop('checked');
        var x = confirm($data);
        if (x)
        {
            if (bool == true)
            {
                $('.collapse').collapse('show');
                $('#passing_year').attr("required", "required");
            } else if (bool == false)
            {
                $('.collapse').collapse('hide');
                $('#passing_year').removeAttr("required");
                $('.disabled input,.disabled select,.disabled textarea,.btn,button').removeAttr('disabled');
            }
            return true;
        } else
        {

            return false;
        }

    }


    $("#stu_mobileno").keyup(function () {

        var stu_mobileno = $("#stu_mobileno").val();

        if (!isNaN(stu_mobileno))
        {

            if (stu_mobileno.length < 11) {
                return true;
            } else {
                alert("Mobile Number Should be less than 10 digits");
                $("#stu_mobileno").val("");
            }
        } else {
            alert("Mobile Number Should be Numeric Only");
            $("#stu_mobileno").val("");
        }

    });


    $("#stu_email_id").keyup(function () {
        var email = $("#stu_email_id").val();

        var isValid = isEmailValid(email);
        if (isValid == false) {
            //alert("sdffs");
            $('#erremail').text("Please enter valid email");
            // $('#to_email').focus();
            $('#stu_email_id').text("");
            return false;
        } else {
            $('#erremail').text("");
            return true;
        }
    });

    $("#secondary_mail").keyup(function () {
        var email = $("#secondary_mail").val();

        var isValid = isEmailValid(email);
        if (isValid == false) {
            //alert("sdffs");
            $('#erremail1').text("Please enter valid email");
            // $('#to_email').focus();
            $('#secondary_mail').text("");
            return false;
        } else {
            $('#erremail1').text("");
            return true;
        }
    });


    function isEmailValid(email) {
        var EMAIL_REGEXP = new RegExp('^[a-z0-9]+(\.[_a-z0-9]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,15})$', 'i');
        return EMAIL_REGEXP.test(email)
    }


    $("#father_mobileno").keyup(function () {

        var father_mobileno = $("#father_mobileno").val();

        if (!isNaN(father_mobileno))
        {

            if (father_mobileno.length < 11) {
                return true;
            } else {
                alert("Mobile Number Should be less than 10 digits");
                $("#father_mobileno").val("");
            }
        } else {
            alert("Mobile Number Should be Numeric Only");
            $("#father_mobileno").val("");
        }

    });

    $("#mother_mobileno").keyup(function () {

        var mother_mobileno = $("#mother_mobileno").val();

        if (!isNaN(mother_mobileno))
        {

            if (mother_mobileno.length < 11) {
                return true;
            } else {
                alert("Mobile Number Should be less than 10 digits");
                $("#mother_mobileno").val("");
            }
        } else {
            alert("Mobile Number Should be Numeric Only");
            $("#mother_mobileno").val("");
        }

    });



    $('body').on('change', '#academic_id', function () {
        var academic_id = $('#academic_id').val();
        var academic_text = $('#academic_id option:selected').text();
        if (academic_id) {
            $('#batch').show();
            $.ajax({
                type: "POST",
                url: '<?php echo $this->mainconfig['host'] . 'master/ajax-get-batch-code'; ?>',
                data: {academic_id: academic_id}
            }).done(function (data) {
                var result = $.parseJSON(data);
                if ((data != '')) {
                    $('#batch').val(result['short_code']);
                }
            });


            $.ajax({
                type: "POST",
                url: '<?php echo $this->mainconfig['host'] . 'student/ajax-get-max-id'; ?>',
                data: {batch_id: academic_id, short_code: academic_text}
            }).done(function (data) {
                $('#stu_id').val(data);
                $('#read_id').val(data);
            });



        }

    });



    $('body').on('change', '#ge', function () {
        var ge_id = $('#ge').val();
        var academic_id = $('#academic_id').val();
        $.ajax({
            type: "POST",
            url: '<?php echo $this->mainconfig['host'] . 'student/ajax-get-Ge-Course'; ?>',
            data: {academic_id: academic_id, ge_id: ge_id}
        }).done(function (data) {
            if (data == 0) {
                alert('Course has not created for this Ge !');
                $('button.submit').hide();
            } else {
                $('button.submit').show();
                $('#ge_course').empty();
                $('#ge_course').html(data);
            }
        });
    });


    var academic_id = $('#academic_id option:selected').val();
    var ge_id = '';
    if (academic_id) {
        $('#batch').show();
        $.ajax({
            type: "POST",
            url: '<?php echo $this->mainconfig['host'] . 'master/ajax-get-batch-code'; ?>',
            data: {academic_id: academic_id}
        }).done(function (data) {
            var result = $.parseJSON(data);
            if ((data != '')) {
                $('#batch').val(result['short_code']);
            }
        });

        $.ajax({
            type: "POST",
            url: '<?php echo $this->mainconfig['host'] . 'master/ajax-get-ge'; ?>',
            data: {academic_id: academic_id}
        }).done(function (data) {
            $('#ge').empty();
            $('#ge').html(data);
            $('#ge').val("<?php echo $this->elective[0]['ge_id']; ?>");
        });



    } else {
        $('#batch').hide();
    }

    $(document).ready(function () {
        $('#effective_date').hide();
        $('#adv_col').hide();
        $('#eff_date').hide();
        $('#advice_label').hide();
        $('body').on('change', '#stu_status', function () {
            var stu_status = $('#stu_status').val();

            if (stu_status == 2) {
                $('#effective_date').show();
                $('#adv_col').show();
                $('#eff_date').show();
                $('#advice_label').show();
            } else {
                $('#effective_date').hide();
                $('#adv_col').hide();
                $('#eff_date').hide();
                $('#advice_label').hide();
            }
        });

        var stu_status = $('#stu_status option:selected').val();
        if (stu_status == 2) {
            $('#effective_date').show();
            $('#adv_col').show();
            $('#eff_date').show();
            $('#advice_label').show();
        } else {
            $('#effective_date').hide();
            $('#adv_col').hide();
            $('#eff_date').hide();
            $('#advice_label').hide();
        }
    });
//Fetch detail of Discontinue person
    function fetchDiscontinuedStudentDetail() {
        var participant_id = $("#stu_id").val();
        $.ajax({
            type: "POST",
            url: '<?php echo $this->mainconfig['host'] . 'student/fetch-discontinued-student-detail'; ?>',
            data: {participant_id: participant_id}
        }).done(function (data) {
            if (data == 0) {
                alert('No Previous Detail Found for this student');
            } else {
                var result = $.parseJSON(data);
                //{"student_id":"29","stu_fname":"Abhishek","stu_lname":"Kumar","gender":"1","stu_mobileno":"9771865393","stu_email_id":"akabhishek119@gmail.com","stu_dob":"","present_addr":"asfasdfasfdafadf","premanent_addr":"asdfasdfasdfasfdasdf","stu_status":"2","effective_date":"14\/02\/2018","adv_col":"test","father_fname":"asdf","father_lname":"asdf","father_mobileno":"123456789","mother_fname":"asdfasdf","mother_lname":"asdf","mother_mobileno":"12345678","academic_id":"2","terms_id":"0","year":"0","stu_id":"PDM03001","status":"0","filename":""}
                $('#stu_fname').val(result['stu_fname']);
                $('#stu_lname').val(result['stu_lname']);
                $('#gender').val(result['gender']);
                $('#stu_mobileno').val(result['stu_mobileno']);
                $('#stu_email_id').val(result['stu_email_id']);
                $('#stu_dob').val(result['stu_dob']);
                $('#present_addr').val(result['present_addr']);
                $('#premanent_addr').val(result['premanent_addr']);
                //$('#stu_status').val(result['stu_status']);
                $('#father_fname').val(result['father_fname']);
                $('#father_lname').val(result['father_lname']);
                $('#father_mobileno').val(result['father_mobileno']);
                $('#mother_fname').val(result['mother_fname']);
                $('#mother_lname').val(result['mother_lname']);
                $('#mother_mobileno').val(result['mother_mobileno']);

            }

        });
    }
</script>



 
    
   

<script>
    ///Raushan
//$('#datatable-responsive').DataTable().buttons().disable();
/// aushan ////
    $(document).ready(function () {

        var text = $('#datatable-responsive_info').text();

        res = text.split("of");

        if (res.length > 0) {

            if (res[1]) {
                act_text = res[1].split("entries");


                $("<div id='custom_data_records'><label>Total Records : <span>" + act_text[0] + "</span></label></div>").insertAfter('#datatable-responsive_length');

                $('input[type="search"]').keyup(function () {
                    $('#custom_data_records').remove();
                    var text = $('#datatable-responsive_info').text();
                    res = text.split("of");
                    act_text = res[1].split("entries");
                    $("<div id='custom_data_records'><label>Total Records : <span>" + act_text[0] + "</span></label></div>").insertAfter('#datatable-responsive_length');
                });
            }
        }
    });



</script>


<script>

<?php if ($this->result['participant_Alumni'] == 1) { ?>
        $('.disabled input,.disabled select,.disabled textarea,.btn,button').attr('disabled', 'disabled');

<?php } ?>
    $('#participant_pword').val('<?= $_SESSION['StuPword']; ?>');

</script>

<script>

    var stu_id = $('#stu_id').val();
    $('#stu_id,#read_id').removeAttr('readonly');
    if (stu_id)
        $('#read_id').val(stu_id);

    $('#print').click(function () {
        window.print('#grade_data');
    });

    $('#aecc').val('<?php echo $this->elective[0]['aecc']; ?>');
    $('#ge').val('<?php echo $this->elective[0]['ge_id']; ?>');
   

    $('#academic_id').change(function () {
        var academic_id = $(this).val();
        if (academic_id) {
            $.ajax({
                type: "POST",
                url: '<?php echo $this->mainconfig['host'] . 'master/ajax-get-ge'; ?>',
                data: {academic_id: academic_id}
            }).done(function (data) {
                $('#ge').empty();
                $('#ge').html(data);
            });
        }
    });

   

	
$(document).on('change','#department',function() { 
    var session_id = $('#session').val();
    var department_id = $('#department').val();
    var degree_id = $('#degree_id').val();
    //alert(session_id);
    $('.load-box').css('display','block');
    $.ajax({
        type: "POST",
        url: '<?php echo $this->mainconfig['host'] . 'student/ajax-get-Student-By-Session'; ?>',
        
        data: {session_id : session_id,department_id:department_id,degree_id:degree_id}
    }).done(function( data ) {
        $('#studentData').empty('');
        $('.load-box').css('display','none');
        $('#studentData').html(data);

    });   
});


     $('#department').attr('disabled','disabled');
    //Added: By Kedar 13 Nov. 2019
    $('body').on('change', '#degree_id', function () {
        $('#department').removeAttr('disabled');
        var degree_id = $('#degree_id').val();
        if (degree_id) {
            
            $.ajax({
                type: "POST",
                url: '<?php echo $this->mainconfig['host'] . 'master/ajax-Get-Dept'; ?>',
                data: {degree_id: degree_id}
            }).done(function (data) {
                $('#department').empty('');
                $('#department').html(data);
                $('#department').trigger("chosen:updated");
            });
        }
    });
    //End
</script>
