<style>
    dt{
        display:none;
    }

</style>
<style>
    @media print {
        table td:nth-child(7)
        {
            display:none;
        }
        table th:nth-child(7)
        {
            display:none;
        }
        *{
            visibility:hidden;
        }
        table,th,td 
        {
            visibility:visible;                    
        } 
        .title1
        {
            visibility:visible; 
        }
    }
</style>

<div class="right_col">
    <?php if($this->type) { ?>
        <div class="padding-md ">
            <div class="row">
                <div class="col-md-12">
                    <h3 class="page-title txt-color-blueDark" >
                        <div><i class="fa fa-eye"> Addon Course Learning</i></div>
                    </h3>
                    <div class="panel panel-default">
                        <form class="no-margin" id="formValidate1" action="<?php echo $this->form->getAction() ?>" method="post" data-validate="parsley" >

                            <div class="panel-body">
                                <div class="row">

                                    <div class="col-sm-3 employee_class">
                                        <div class="form-group">
                                         <label class="control-label">Academic Year<span class="asterisk">*</span></label>
                                            <?php echo $this->form->academic_year; ?>
                                        </div>
                                    </div>
<?php echo $this->form->csrftoken; ?>	
                                    
<!--                                    <div class="col-sm-3 employee_class">
                                        <div class="form-group">
                                            <label class="control-label"> Degree<span class="asterisk">*</span></label>
                                            <?php //echo $this->form->degree_id; ?>
                                        </div>
                                    </div>-->
                                    
                                     <div class="col-sm-3 employee_class">
                                        <div class="form-group">
                                           <label class="control-label">Addon Course <span class="asterisk">*</span></label>
                                            <?php echo $this->form->addon_course_list; ?>
                                        </div>
                                    </div> 
                                    
                                    <div class="col-sm-3 employee_class">
                                        <div class="form-group">
                                           <label class="control-label">Addon Course Paper<span class="asterisk">*</span></label>
                                            <?php echo $this->form->course_id; ?>
                                        </div>
                                    </div> 

                                  
                             
                                    
                                    <div class="col-sm-3 employee_class">
                                        <div class="form-group">
                                            <label class="control-label">Total Credits:</label>
                                            <input type="text" name="tot_credit" id="tot_credit" value="<?=$this->result['tot_credit']?>"  class="form-control" readonly>
                                        </div>
                                    </div>

                                    <div class="col-sm-3 employee_class">
                                        <div class="form-group">
                                            <label class="control-label">Remaining Credits:</label>
                                            <input type="text" name="re_credit" id="re_credit" class="form-control" readonly value="<?php echo $this->result['re_credit']; ?>" >
                                        </div>
                                    </div> 
                                    
                                     <div class="col-sm-3 employee_class">
                                        <div class="form-group">
                                            <label class="control-label">Credit<span class="asterisk">*</span></label>
                                            <?php echo $this->form->credit_id; ?>
                                        </div>
                                    </div>

                                      <div class="col-sm-3 employee_class">
                                        <div class="form-group">
                                            <label class="control-label">Countable<span class="asterisk">*</span></label>
                                            <?php echo $this->form->count_id; ?>
                                        </div>
                                    </div>

<!--                                    <input type="hidden" name="ccl_id" id="ccl_id" value="<?php echo $this->result['ccl_id']; ?>"/>-->

                                </div>
                            </div>
                            <div>
                                <div class="panel-footer">									
                                    <div class="row">
                                        <div class="col-sm-7 col-sm-offset-5">
                                            <?php if ($this->type == 'add') { ?> 
                                                <div style="float:left;margin-right:2px;" >
                                                    <button class="btn btn-primary submit" id="removebtn">Submit</button>
                                                </div>
                                                <div style="float:left;padding:0px 10px;">
                                                    <button type="reset" class="btn btn-danger btn-default">Reset</button>
                                                </div>
                                            <?php } else if ($this->type == 'add') { ?>	
                                                <div style="float:left;margin-right:2px;">
                                                    <button class="btn btn-primary submit">Submit</button>
                                                </div>
                                            <?php } else { ?>
                                                <div style="float:left;">
                                                    <button class="btn btn-primary submit">Update</button>
                                                </div>
                                                <div style="float:left;">
                                                    <a class="btn btn-primary" href="<?php echo $this->mainconfig['host']; ?>master/corecourselearning">Back</a>
                                                </div>
                                            <?php } ?>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div><!-- /panel -->
                </div><!-- /.col-->				
            </div><!-- /.row -->

        </div><!-- /.padding-md -->	
    <?php } else { ?>

        <?php if (count($this->messages)) {
            foreach ($this->messages as $message) {
                ?>
                <div class="alert <?php echo $_SESSION['message_class']; ?> ">
                    <a type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</a>
                <?php echo $this->escape($message); ?>
                </div>
        <?php }
    } ?>
        <!-- widget grid -->
        <div class="">
            <div class="">
                <div class="row">
                     <div class="load-box">
                <img src="<?php echo $this->mainconfig['publicpath']; ?>/images/loader.gif" width='200px'  class="loder_img1" />
            </div> 
                    <div class="col-xs-12 col-sm-7 col-md-7 col-lg-4">
                        <h3 class="page-title txt-color-blueDark">
                            <i class="fa fa-bars"> Addon Course Learning </i>

                        </h3>
                    </div>

                    <div class="col-xs-12 col-sm-5 col-md-5 col-lg-8">	 

                        <a class="btn btn-primary pull-right" style="margin-top: 25px;" href="<?php echo $this->mainconfig['host']; ?>master/addon-course-migration">Bulk Add </a>
                        <a class="btn btn-primary pull-right" style="margin-top: 25px;" href="<?php echo $this->mainconfig['host']; ?>master/addoncourselearning/type/add">Add </a>
                    </div>
                </div>

                <div class="x_panel">

                    <div class="x_title">
                        <div class="col-sm-3 employee_class">
                            <div class="form-group">
                                <label class="control-label">Academic Year</label>
                                <?php echo $this->form->academic_year; ?>
                            </div>
                        </div>    
                      
                    <div class="col-sm-3 employee_class">
                        <div class="form-group">
                            <label class="control-label">Addon Course Group </label>
                            <?php echo $this->form->addon_course_list; ?>
                        </div>
                    </div>	
                        <ul class="nav navbar-right panel_toolbox">
                            <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                            </li>
                            <li class="dropdown">
                                <a href="" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-wrench"></i></a>
                            </li>
                            <li><a class=""><i class="fa fa-close"></i></a>
                            </li>
                        </ul>
                        <div class="clearfix"></div>
                    </div>
                    <div class="x_content">

                        <div class="padding-md clearfix">
                            <div class="col-sm-0" style="float:right;">
                                           <!-- <a class="btn btn-primary" target="_blank" href="#<?php //echo $this->mainconfig['host'];  ?>fee-structure/structure-pdf/id/<?php //echo $this->structure_id;  ?>">Print</a>--><a class="btn btn-link" role="button" href="#" id="print"><span class='glyphicon glyphicon-print'></span></a></div>
                            <div class="table-responsive" id="studentData"> 
                            <table class="table table-striped table-bordered mb30 jambo_table bulk_action" id="datatable-responsive">
                                <thead>
                                    <tr>
                                        <th style="text-align:center;" >S.No.</th>	
                                        <th style="text-align:center;" >Batch</th>
                                        <th style="text-align:center;" >Term</th>
                                        <th style="text-align:center;" >Course Category</th>
                                        <th style="text-align:center;" >Course Name</th>
                                        <th style="text-align:center;" >Course Code</th>
                                        <th style="text-align:center;" >Countable</th>
                                        <th style="text-align:center;" >Credit</th>
                                        <th class="no_print" style="text-align:center;" >Action</th>
                                    </tr>
                                </thead>
                                <tbody style="text-align:center;" >
                                    <?php
                                    $i = 1;
                                    $pagination_tr = '';
                                    if (count($this->paginator) != 0) {

                                        foreach ($this->paginator as $results) {
                                            //print_r($results);die;
                                            ?>
                                            <tr>
                                                <td><?php echo $i;

                                            $i++;
                                            ?>
                                                </td>		
                                                <td><?php echo $results['short_code']; ?></td>
                                                <td><?php echo $results['term_name']; ?></td>
                                                <td><?php echo $results['cc_name'] ?></td>
                                                <td><?php echo $results['course_name'] ?></td>
                                                <td><?php echo $results['course_code'] ?></td>
                                                <td><?php if($results['count_id'] == 0){echo 'YES';}else{
                                                    echo "NO";
                                                } ?></td>
                                                <td><?php echo $results['credit_value'] ?></td>
                                                <td><a href="<?php echo $this->mainconfig['host']; ?>master/addoncourselearning/type/edit/id/<?php echo $results['ccl_id']; ?>" class="edit" title="Edit"><span class="fa fa-edit fa-lg"></span></a><!--&nbsp; | &nbsp;  <a href="<?php echo $this->mainconfig['host']; ?>master/corecourselearning/type/delete/id/<?php // echo $results['ccl_id'];  ?>" onclick="return ConfirmDelete();" title="Delete" class="delete"> <span class="fa fa-trash-o fa-lg"></span> </a>--></td>

                                            </tr>            

                                        <?php
                                        }
                                        $pagination_tr = $this->paginationControl($this->paginator, 'Sliding', 'pagination.phtml');
                                    }
                                    ?>

                                </tbody>
                            </table>
                            </div>
    <?php echo $pagination_tr; ?>
                        </div><!-- /.padding-md -->
                    </div><!-- /panel -->
                </div>
            </div>
        </div><!-- /.padding-md -->		
<?php } ?>
</div>
<script>
   
 let type='<?= $this->type ?>';
    if(type == 'add'){
    $('#addon_course_list').change(function () {
        var academic_year = $('#academic_year').val(); 
        var degree_id = $('#addon_course_list').val(); 
        if (degree_id) {
            $.ajax({
                type: "POST",
                url: '<?php echo $this->mainconfig['host'] . 'master/ajax-get-addon'; ?>',
                data: {degree_id:degree_id}
            }).done(function (data) {
                $('#course_id').empty();
                $('#course_id').html(data);
                $("#course_id").trigger("chosen:updated");
                
            });
            
            $.ajax({
                type: "POST",
                url: '<?php echo $this->mainconfig['host'] . 'master/ajax-get-addon-credit'; ?>',
                data: {degree_id:degree_id}
            }).done(function (data) {
                var totcredit =data;
                $('#tot_credit').empty();
                $('#tot_credit').val(data);
                
                $.ajax({
                type: "POST",
                url: '<?php echo $this->mainconfig['host'] . 'master/ajax-get-addon-re-credit'; ?>',
                data: {degree_id:degree_id}
            }).done(function (data) {
               
                if(data){
                   if(data==='0'){
                      alert('No Remaing Credit Found For this Course') ;
                     location.reload();
                     
                 }  else {
                $('#re_credit').empty();
                $('#re_credit').val(data);
                }
                }
                else {
               // alert(totcredit);
                $('#re_credit').empty();
                $('#re_credit').val(totcredit);    
                    }
       
            });
          
             });
              }

    });
    }
    
     if(type == 'edit'){
     
        $("#academic_year").prop( "disabled", true ); 
        $("#addon_course_list").prop( "disabled", true ); 
        $("#course_id").prop( "disabled", true ); 
        
        
         $( "#formValidate1" ).submit(function( event ) {
        $("#academic_year").prop( "disabled", false ); 
        $("#addon_course_list").prop( "disabled", false ); 
        $("#course_id").prop( "disabled", false ); 
         });
        
     }
    
    
    $('#addon_course_list').change(function () {
        var academic_year = $('#academic_year').val(); 
        var degree_id = $('#addon_course_list').val()
        
        
          $.ajax({
                type: "POST",
                url: '<?php echo $this->mainconfig['host'] . 'master/ajax-get-student-by-course-addon'; ?>',
                data: {degree_id:degree_id,academic_year:academic_year}
            }).done(function (data) {
                $('#studentData').empty();
                $('#studentData').html(data);
               
                
            });
        
        
       });     
        
      $('#ct_id').change(function () {
       
        var ct_id = $('#ct_id').val(); 
        if (ct_id) {
            $.ajax({
                type: "POST",
                url: '<?php echo $this->mainconfig['host'] . 'master/ajax-get-addon-course'; ?>',
                data: {ct_id:ct_id}
            }).done(function (data) {
                $('#course_id').empty();
                $('#course_id').html(data);
                $("#course_id").trigger("chosen:updated");
                
            });
             
        }

    });
  $('#credit_id').change(function () {
       var credit_id = $('#credit_id').val(); 
    $.ajax({
            type: "POST",
            url: '<?php echo $this->mainconfig['host'] . 'master/ajax-get-creditid-value'; ?>',
            data: {credit_id: credit_id}

        }).done(function (data) {
             
              var result1 = JSON.parse(data);
              var creditval = result1['credit_value'];
             var tot_credit = $('#re_credit').val();
             var recredit = tot_credit-creditval;
         $('#re_credit').val(recredit);
        });
        });

  $("#academic_year").change(function () {
        var academic_year = $('#academic_year').val();
        if (academic_year) {
  $.ajax({
    type: "POST",
     url: '<?php echo $this->mainconfig['host'] . 'master/ajax-get-addon-courses-by-session'; ?>',
     data: {academic_year: academic_year}
            }).done(function (data) {
             $('#addon_course_list').empty('');
             $('#addon_course_list').html(data);
             $('#addon_course_list').trigger("chosen:updated");
             });
                 }
 });
</script>
